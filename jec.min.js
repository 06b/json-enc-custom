!function(){let e;function t(e){return 0===e.length?null:1===e.length?e[0]:e}function n(e,t){return function(e){return 1===e.length&&e[0]instanceof HTMLInputElement&&"checkbox"===e[0].type}(t)?null===e?"off":e:l(t)||i(t)?Array.isArray(e)?e:null===e?[]:[e]:e}function r(e,t,n){const r=`[name="${n}"]`;return t?t.closest("form").querySelectorAll(r):e.closest("form").querySelectorAll(r)}function l(e){return 1===e.length&&e[0]instanceof HTMLSelectElement&&"select-multiple"===e[0].type}function i(e){if(0===e.length)return!1;for(const t of e)if(!(t instanceof HTMLInputElement&&"checkbox"===t.type))return!1;return!0}function u(e,t,n){if(e.length||void 0===t||(e=t.matches(match)?[t]:t.querySelectorAll(match)),!Array.isArray(n))return o(e[0],n);if(l(e)){const t=e[0],r=s(t);for(let e=0;e<n.length;e++){let l=n[e];r&&(l=Number(l)),n[e]=o(t,l)}return n}if(i(e))for(let t=0;t<e.length;t++){let r=e[t];n[t]=o(r,null)}else for(let t=0;t<n.length;t++){let r=e[t],l=n[t];n[t]=o(r,l)}return n}function o(e,t){switch(!0){case e instanceof HTMLInputElement:switch(e.type){case"checkbox":return e.checked;case"number":case"range":return Number(t)}break;case e instanceof HTMLSelectElement:if("select-one"===e.type&&s(e))return Number(t)}return t}function s(e){const t=[...e.options].map(e=>e.value);if(0==t.length)return!0;for(const e of t)if(isNaN(Number(e)))return!1;return!0}function c(e){let t=e;const n=[{type:"object",key:t,last:!0,next_type:null}];let r=Array(),l=String();for(let e=0;e<t.length&&"["!==t[e];e++)l+=t[e];if(""===l)return n;for(t=t.slice(l.length),r.push({type:"object",key:l,last:!1,next_type:null});t.length;){if(!t.startsWith("[]")){if(/^\[\d+\]/.test(t)){t=t.slice(1);let e=t.match(/\d+/)[0];t=t.slice(e.length);let n=parseInt(e,10);t=t.slice(1),r.push({type:"array",key:n,last:!1,next_type:null});continue}if(/^\[[^\]]+\]/.test(t)){t=t.slice(1);let e=t.match(/[^\]]+/)[0];t=t.slice(e.length);let n=e;t=t.slice(1),r.push({type:"object",key:n,last:!1,next_type:null});continue}return n}t=t.slice(2),r.push({type:"array",key:null,last:!1,next_type:null})}for(let e=0;e<r.length;e++)if(e===r.length-1){let t=r[e];t.last=!0,r[e]=t}else{let t=r[e];t.next_type=r[e+1].type,r[e]=t}return r}function a(e,t,n){if(t.last){if(null===t.key){if(null===n)return e;if("array"===t.type)if(Array.isArray(n))for(const t in n)e[t]=n[t];else e[0]=n;return e}if(null!==n)return e[t.key]=n,e[t.key]}if(void 0!==e[t.key])return e[t.key];if("object"===t.type){if("object"===t.next_type)return e[t.key]={},e[t.key];if("array"===t.next_type)return e[t.key]=[],e[t.key]}if("array"===t.type){if("object"===t.next_type)return e[t.key]={},e[t.key];if("array"===t.next_type)return e[t.key]=[],e[t.key]}}htmx.defineExtension("json-enc-custom",{init:function(t){e=t},onEvent:function(e,t){if("htmx:configRequest"===e){t.detail.elt.hasAttribute("hx-multipart")?t.detail.headers["Content-Type"]="multipart/form-data":t.detail.headers["Content-Type"]="application/json"}},encodeParameters:function(l,i,o){o.hasAttribute("hx-multipart")||l.overrideMimeType("text/json");let s=function(t){let n=e.getClosestAttributeValue(t,"hx-include");if(n){let r=e.getClosestMatch(t,function(e){return e.matches(`[hx-include="${n}"]`)});return e.querySelectorExt(r,n)}}(o),f=function(l,i,o){let s=[],f=Object.create(null);const y="true"===e.getAttributeValue(i,"parse-types");let m;o?o.elements?m=new Set(Array.from(o.elements,e=>e.name)):o.form&&o.form.elements&&(m=new Set(Array.from(o.form.elements,e=>e.name))):i.elements?m=new Set(Array.from(i.elements,e=>e.name)):i.form&&i.form.elements&&(m=new Set(Array.from(i.form.elements,e=>e.name)));if(!m)return"";for(const e of m){if(0===e.length)continue;let m=l.getAll(e);if(m=t(m),m instanceof File){s.push(m);continue}if(Array.isArray(m)&&Object.values(m).every(e=>e instanceof File)){s=Object.values(m);continue}const p=r(i,o,e);m=n(m,p),y&&(m=u(p,o,m));let h=c(e),g=f;for(let e=0;e<h.length;e++){g=a(g,h[e],m)}}let p=JSON.stringify({...f,...e.getExpressionVars(i)});if(i.hasAttribute("hx-multipart")){const e=new FormData;e.append("data",p);for(const t of s)e.append("file",t);return e}return p}(i,o,s);return f}})}();